[{"retrosynthesis": 2, "prediction": 1, "conditional": 1, "graph": 1, "logic": 1, "network": 1, "hanjun": 1, "dai": 2, "chengtao": 1, "li2": 1, "": 7, "connor": 1, "w": 1, "coley": 1, "bo": 1, "le": 1, "song": 1, "google": 1, "research": 1, "brain": 1, "team": 1, "hadai": 1, "bodaigooglecom": 1, "2": 1, "galixir": 1, "inc": 1, "chengtaoligalixircom": 1, "massachusetts": 1, "institute": 2, "technology": 2, "ccoleymitedu": 1, "georgia": 1, "ant": 1, "financial": 1, "lsongccgatechedu": 1, "abstract": 1, "one": 1, "fundamental": 1, "problems": 1, "organic": 1, "chemistry": 1}, {"task": 1, "identify": 1, "reactants": 1, "use": 1, "synthesize": 1, "specify": 1, "product": 1, "molecule": 1}, {"recently": 1, "computeraided": 1, "retrosynthesis": 1, "find": 1, "renew": 1, "interest": 1, "chemistry": 1, "computer": 1, "science": 1, "communities": 1}, {"exist": 1, "approach": 1, "rely": 1, "templatebased": 1, "model": 1, "define": 2, "subgraph": 1, "match": 1, "rule": 2, "whether": 1, "chemical": 1, "reaction": 1, "proceed": 1, "hard": 1, "decision": 1}, {"work": 1, "propose": 1, "new": 1, "approach": 1, "task": 1, "use": 1, "conditional": 2, "graph": 2, "logic": 1, "network": 2, "graphical": 1, "model": 1, "build": 1, "upon": 1, "neural": 1, "learn": 1, "rule": 1, "reaction": 2, "templates": 1, "apply": 1, "implicitly": 1, "consider": 1, "whether": 1, "result": 1, "would": 1, "chemically": 1, "feasible": 1, "strategic": 1}, {"also": 1, "propose": 1, "efficient": 1, "hierarchical": 1, "sample": 1, "alleviate": 1, "computation": 1, "cost": 1}, {"achieve": 1, "significant": 1, "improvement": 1, "81": 1, "current": 1, "stateoftheart": 1, "methods": 1, "benchmark": 1, "dataset": 1, "model": 1, "also": 1, "offer": 1, "interpretations": 1, "prediction": 1}, {"1": 1, "": 2, "introduction": 1, "retrosynthesis": 1, "plan": 1, "procedure": 1, "identify": 1, "series": 1, "reactions": 1, "lead": 1, "synthesis": 1, "target": 1, "product": 1}, {"first": 1, "formalize": 1, "e": 1, "j": 1, "corey": 1, "1": 1, "become": 1, "one": 1, "fundamental": 1, "problems": 1, "organic": 1, "chemistry": 1}, {"problem": 1, "work": 1, "backwards": 1, "target": 1, "challenge": 1, "due": 1, "size": 1, "search": 1, "spacethe": 1, "vast": 1, "number": 1, "theoreticallypossible": 1, "transformationsand": 1, "thus": 1, "require": 1, "skill": 1, "creativity": 1, "experience": 1, "chemists": 1}, {"recently": 1, "various": 1, "computer": 1, "algorithms": 1, "2": 1, "work": 1, "assistance": 1, "experience": 1, "chemists": 1, "save": 1, "tremendous": 1, "time": 1, "effort": 1}, {"simplest": 1, "formulation": 1, "retrosynthesis": 1, "take": 1, "target": 1, "product": 1, "input": 1, "predict": 1, "possible": 1, "reactants": 1, "1": 1, "": 1}, {"essentially": 1, "reverse": 1, "problem": 1, "reaction": 1, "prediction": 1}, {"reaction": 1, "prediction": 1, "reactants": 1, "sometimes": 1, "reagents": 1, "well": 1, "give": 1, "input": 1, "desire": 1, "output": 1, "possible": 1, "products": 1}, {"case": 1, "atoms": 2, "desire": 1, "products": 2, "subset": 1, "reactants": 1, "since": 1, "side": 1, "often": 1, "ignore": 1, "see": 1, "fig": 1, "1": 1}, {"thus": 1, "model": 1, "essentially": 1, "design": 1, "identify": 1, "subset": 1, "reactant": 1, "atoms": 1, "reassemble": 1, "product": 1}, {"treat": 1, "deductive": 1, "reason": 1, "process": 1}, {"sharp": 1, "contrast": 1, "retrosynthesis": 1, "identify": 1, "superset": 1, "atoms": 1, "target": 1, "products": 1, "thus": 1, "abductive": 1, "reason": 1, "process": 1, "require": 1, "creativity": 1, "solve": 1, "make": 1, "harder": 1, "problem": 1}, {"although": 1, "recent": 1, "advance": 2, "graph": 1, "neural": 1, "network": 1, "lead": 1, "superior": 1, "performance": 1, "reaction": 1, "prediction": 1, "3": 1, "4": 1, "5": 1, "transfer": 1, "retrosynthesis": 1}, {"computeraided": 1, "retrosynthesis": 1, "design": 1, "deploy": 1, "past": 1, "years": 1, "since": 1, "6": 1}, {"completely": 1, "rulebased": 1, "systems": 1, "7": 1, "scale": 1, "well": 1, "due": 1, "high": 1, "computation": 1, "cost": 1, "": 3, "1": 1, "work": 1, "do": 1, "hanjun": 1, "georgia": 1, "institute": 1, "technology": 1, "focus": 1, "single": 1, "step": 1, "version": 1, "retrosynthesis": 1, "paper": 1}, {"33rd": 1, "conference": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "neurips": 1, "2019": 1, "vancouver": 1, "canada": 1}, {"c": 3, "": 78, "reactions": 2, "retrosynthesis": 2, "templates": 2, "heteroatom": 1, "alkylation": 1, "arylation": 1, "nh": 6, "n": 1, "c1": 4, "f": 21, "n5": 2, "h2n": 1, "c4": 2, "n4": 2, "c3": 4, "c5": 2, "acylation": 1, "relate": 1, "process": 1, "c2": 2, "o2": 2, "figure": 1, "1": 1, "chemical": 1}, {"reaction": 2, "center": 1, "highlight": 1, "participant": 1}, {"center": 1, "extract": 1, "form": 1, "correspond": 1, "template": 1}, {"note": 1, "atoms": 1, "belong": 1, "reaction": 1, "side": 1, "products": 1, "dash": 1, "box": 1, "figure": 1, "miss": 1}, {"incomplete": 1, "coverage": 1, "rule": 2, "especially": 1, "expertdefined": 1, "algorithmically": 1, "extract": 1, "2": 1}, {"despite": 1, "limitations": 1, "useful": 1, "encode": 1, "chemical": 1, "transformations": 1, "easy": 1, "interpret": 1}, {"base": 1, "retrosim": 1, "8": 1, "use": 1, "molecule": 1, "reaction": 1, "fingerprint": 1, "similarities": 1, "select": 1, "rule": 1, "apply": 1, "retrosynthesis": 1}, {"approach": 1, "use": 1, "neural": 1, "classification": 1, "model": 1, "selection": 1, "task": 1, "9": 1}, {"hand": 1, "recently": 1, "also": 1, "attempt": 1, "use": 1, "sequencetosequence": 1, "model": 1, "directly": 1, "predict": 1, "smile": 1, "2": 1, "representation": 1, "reactants": 1, "10": 1, "11": 1, "forward": 1, "prediction": 1, "problem": 1, "products": 1, "12": 1, "13": 1}, {"albeit": 1, "simple": 1, "expressive": 1, "approach": 1, "ignore": 1, "rich": 1, "chemistry": 1, "knowledge": 1, "thus": 1, "require": 1, "huge": 1, "amount": 1, "train": 1}, {"also": 1, "model": 1, "lack": 1, "interpretable": 1, "reason": 1, "behind": 1, "predictions": 1}, {"current": 1, "landscape": 1, "computeraided": 1, "synthesis": 1, "plan": 1, "motivate": 1, "us": 1, "pursue": 1, "algorithm": 1, "share": 1, "interpretability": 1, "templatebased": 1, "methods": 1, "take": 1, "advantage": 1, "scalability": 1, "expressiveness": 1, "neural": 1, "network": 1, "learn": 1, "rule": 1, "apply": 1}, {"paper": 1, "propose": 1, "conditional": 2, "graph": 1, "logic": 2, "network": 1, "towards": 1, "direction": 1, "chemistry": 1, "knowledge": 1, "reaction": 1, "templates": 1, "treat": 1, "rule": 2, "graphical": 1, "model": 1, "introduce": 1, "tolerate": 1, "noise": 1}, {"model": 1, "variables": 1, "molecules": 2, "synthetic": 1, "relationships": 1, "infer": 1, "define": 1, "among": 1, "group": 1}, {"furthermore": 1, "handle": 1, "potentially": 1, "infinite": 1, "number": 1, "possible": 1, "molecule": 1, "entities": 1, "exploit": 1, "neural": 1, "graph": 1, "embed": 1, "model": 1}, {"contribution": 1, "summarize": 1, "follow": 1, "1": 1, "propose": 1, "new": 1, "graphical": 1, "model": 1, "challenge": 1, "retrosynthesis": 1, "task": 1}, {"model": 2, "bring": 1, "benefit": 1, "capacity": 1, "neural": 1, "embeddings": 1, "interpretability": 1, "tight": 1, "integration": 1, "probabilistic": 1, "chemical": 1, "rule": 1}, {"2": 1, "propose": 1, "efficient": 1, "hierarchical": 1, "sample": 1, "method": 1, "approximate": 1, "learn": 1, "exploit": 1, "structure": 1, "rule": 1}, {"algorithm": 1, "make": 1, "train": 1, "feasible": 1, "also": 1, "provide": 1, "interpretations": 1, "predictions": 1}, {"3": 1, "experiment": 1, "benchmark": 1, "datasets": 1, "show": 1, "significant": 1, "81": 1, "improvement": 1, "exist": 1, "stateoftheart": 1, "methods": 1, "topone": 1, "accuracy": 1}, {"relate": 1, "work": 2, "recently": 1, "use": 1, "machine": 1, "learn": 1, "enhance": 1, "rule": 1, "systems": 1}, {"treat": 1, "rule": 2, "selection": 1, "multiclass": 1, "classification": 2, "9": 1, "hierarchical": 1, "14": 1, "similar": 1, "group": 1, "subcategories": 1}, {"one": 1, "potential": 1, "issue": 1, "model": 1, "size": 1, "grow": 1, "number": 1, "rule": 1}, {"work": 1, "directly": 1, "model": 2, "conditional": 1, "joint": 1, "probability": 1, "rule": 2, "reactants": 1, "use": 1, "embeddings": 1, "size": 1, "invariant": 1}, {"hand": 1, "researchers": 1, "try": 1, "tackle": 1, "even": 1, "harder": 1, "problem": 1, "multistep": 1, "retrosynthesis": 2, "15": 1, "16": 1, "use": 1, "singlestep": 1, "subroutine": 1}, {"improvement": 2, "singlestep": 1, "retrosynthesis": 2, "could": 1, "directly": 1, "transfer": 1, "multistep": 1, "8": 1}, {"2": 1, "": 2, "background": 1, "n": 2, "chemical": 1, "reaction": 1, "see": 1, "transformation": 1, "set": 1, "reactant": 1, "molecules": 1, "ri": 1, "i1": 1, "outcome": 1, "molecule": 1}, {"without": 1, "loss": 1, "generality": 1, "work": 1, "singleoutcome": 2, "reactions": 2, "paper": 1, "standard": 1, "formulation": 1, "retrosynthetic": 1, "problem": 1, "multioutcome": 1, "split": 1, "multiple": 1, "ones": 1}, {"refer": 1, "set": 1, "atoms": 1, "change": 1, "eg": 1, "bond": 1, "add": 1, "delete": 1, "reaction": 2, "center": 1}, {"give": 1, "reaction": 1, "correspond": 1, "2": 1, "": 1, "httpswwwdaylightcomdayhtmldoctheorytheorysmileshtml": 1}, {"2": 1, "": 3, "retrosynthesis": 1, "template": 1, "represent": 1, "subgraph": 1, "pattern": 1, "rewrite": 1, "rule": 1, "3": 1, "ot": 1}, {"r1t": 1, "": 3, "r2t": 1}, {"": 1}, {"": 1}, {"": 6, "rn": 1, "1": 1, "n": 1, "represent": 1, "number": 1, "reactant": 1, "subgraphs": 1, "template": 1, "illustrate": 1, "figure": 1}, {"1": 1}, {"generally": 1, "treat": 1, "subgraph": 1, "pattern": 1, "ot": 1, "extract": 1, "reaction": 1, "center": 1, "rit": 1, "": 2, "2": 2, "1": 1}, {"": 1}, {"": 1}, {"": 2, "n": 1, "correspond": 1, "pattern": 1, "inside": 1, "ith": 1, "reactant": 1, "though": 1, "practically": 1, "include": 1, "neighbor": 1, "structure": 1, "reaction": 1, "center": 1, "well": 1}, {"first": 1, "introduce": 1, "notations": 1, "represent": 2, "chemical": 1, "entities": 1, "": 1, "subgraph": 2, "pattern": 2, "use": 1, "lower": 1, "case": 1, "letter": 1}, {"": 1, "molecule": 2, "use": 1, "capital": 1, "letter": 1, "represent": 1, "graph": 1}, {"default": 1, "use": 1, "outcome": 1, "molecule": 3, "r": 1, "reactant": 1, "general": 1}, {"": 1, "set": 2, "represent": 1, "calligraphic": 1, "letter": 1}, {"use": 1, "denote": 3, "full": 1, "set": 1, "possible": 1, "molecules": 1, "extract": 1, "retrosynthetic": 1, "templates": 2, "f": 1, "subgraph": 1, "pattern": 1, "involve": 1, "know": 1}, {"use": 1, "fo": 2, "denote": 2, "subgraphs": 1, "appear": 2, "reaction": 1, "outcomes": 1, "fr": 2, "reactants": 1, "f": 1, "": 2}, {"task": 1, "give": 1, "production": 1, "target": 2, "molecule": 1, "goal": 1, "onestep": 1, "retrosynthetic": 1, "analysis": 1, "identify": 1, "set": 1, "reactant": 1, "molecules": 1, "r": 1, "2": 1, "pm": 1, "use": 1, "synthesize": 1}, {"pm": 1, "power": 1, "set": 1, "molecules": 1, "": 7, "3": 1, "conditional": 1, "graph": 1, "logic": 1, "network": 1, "let": 1, "im": 1, "f": 1, "7": 1}, {"0": 1, "1": 1, "predicate": 1, "indicate": 1, "whether": 1, "subgraph": 2, "pattern": 1, "inside": 1, "molecule": 1, "": 1}, {"check": 1, "via": 1, "subgraph": 1, "match": 1}, {"use": 1, "retrosynthetic": 1, "template": 1, "": 2, "ot": 1}, {"r1t": 1, "": 3, "r2t": 1}, {"": 1}, {"": 1}, {"": 2, "rn": 1, "reason": 1, "reaction": 1, "decompose": 1, "twostep": 1, "logic": 1}, {"first": 1}, {"match": 2, "template": 2, "": 9, "iot": 1, "2": 2, "subgraph": 2, "pattern": 1, "reaction": 1, "product": 2, "ie": 1, "ot": 1}, {"second": 1, "qn": 1, "": 1, "ii": 1}, {"match": 1, "reactants": 1, "3": 1, "ot": 1, "r": 1, "": 11, "ir": 1, "n": 1, "i1": 1, "iri": 1, "ri": 1, "set": 1, "subgraph": 1, "pattern": 1, "r1": 1}, {"": 1}, {"": 1}, {"": 5, "rn": 1, "reaction": 2, "template": 3, "match": 3, "set": 3, "reactants": 1, "r": 3, "logic": 1, "size": 1, "reactant": 3, "number": 1, "pattern": 2, "exist": 1, "permutation": 1, "elements": 1, "correspond": 1, "subgraph": 1}, {"since": 1, "still": 1, "uncertainty": 2, "whether": 1, "reaction": 1, "possible": 1, "chemical": 1, "perspective": 1, "even": 1, "template": 1, "match": 1, "want": 1, "capture": 1, "allow": 1, "templateor": 1, "logic": 1, "reason": 1, "rule": 1, "different": 1, "confidence": 1, "score": 1}, {"specifically": 1, "use": 1, "template": 2, "score": 2, "function": 2, "w1": 1, "give": 2, "product": 2, "reactant": 1, "w2": 1, "r": 1}, {"thus": 1, "overall": 1, "probabilistic": 1, "model": 1, "reaction": 1, "template": 1, "set": 1, "molecules": 1, "r": 1, "design": 1}, {"match": 1, "template": 1, "pt": 1, "": 3, "exp": 1, "w1": 1, "4": 1, "ii": 1}, {"match": 1, "reactants": 1, "prt": 1, "": 2, "exp": 1, "w2": 1, "r": 2, "ot": 1}, {"5": 1, "": 6, "give": 1, "two": 1, "step": 1, "probabilistic": 1, "reason": 1, "model": 3, "joint": 1, "probability": 1, "singlestep": 1, "retrosythetic": 1, "proposal": 1, "use": 1, "reaction": 1, "template": 1, "reactant": 1, "set": 1, "r": 4, "write": 1, "p": 1, "exp": 1, "w1": 1, "w2": 1, "ot": 1, "6": 1, "energybased": 1, "whether": 1, "graphical": 1, "gm": 1, "direct": 1, "undirected": 1, "design": 1, "choice": 1}, {"present": 1, "direct": 1, "gm": 1, "design": 1, "correspond": 1, "partition": 1, "function": 1, "sec": 1, "4": 1, "shortly": 1}, {"name": 1, "model": 1, "conditional": 1, "graph": 1, "logic": 1, "network": 1, "gln": 1, "fig": 1}, {"2": 1, "conditional": 1, "graphical": 1, "model": 1, "define": 1, "logic": 2, "rule": 1, "variables": 1, "graph": 1, "structure": 1, "ie": 1, "molecules": 1, "subgraph": 1, "pattern": 1, "etc": 1}, {"model": 1, "assume": 1, "satisfy": 1, "templates": 1, "necessary": 1, "condition": 1, "retrosynthesis": 1, "ie": 1, "p": 1, "r": 2, "6": 1, "0": 1, "": 1, "ot": 1, "nonzero": 1}, {"restriction": 1, "provide": 1, "sparse": 1, "structure": 1, "model": 1, "make": 1, "abductive": 1, "type": 1, "reason": 1, "feasible": 1}, {"3": 2, "": 6, "commonly": 1, "encode": 1, "use": 1, "smartssmirks": 1, "pattern": 1}, {"": 14}, {"": 4}, {"": 4, "figure": 1, "2": 1, "retrosynthesis": 1, "pipeline": 1, "gln": 1}, {"three": 1, "dash": 1, "box": 1, "top": 1, "bottom": 1, "represent": 2, "set": 1, "templates": 2, "": 1, "subgraphs": 1, "f": 1, "molecules": 1, "different": 2, "color": 1, "retrosynthesis": 1, "rout": 1}, {"dash": 1, "line": 1, "represent": 1, "potentially": 1, "possible": 1, "rout": 1, "observe": 1}, {"reaction": 1, "center": 1, "products": 1, "highlight": 1}, {"reaction": 2, "type": 2, "conditional": 1, "model": 1, "situations": 1, "perform": 1, "retrosynthetic": 1, "analysis": 1, "human": 1, "expert": 1, "may": 1, "already": 1, "certain": 1, "c": 1, "mind": 1}, {"case": 1, "model": 3, "easily": 1, "adapt": 1, "incorporate": 1, "well": 1, "pr": 1, "c": 2, "": 5, "exp": 1, "w1": 1, "w2": 1, "r": 2, "ot": 1, "2": 1, "tc": 2, "7": 1, "set": 1, "retrosynthesis": 1, "templates": 1, "belong": 1, "reaction": 1, "type": 1, "gln": 1, "relate": 1, "significantly": 1, "different": 1, "markov": 1, "logic": 2, "network": 1, "mln": 1, "also": 1, "use": 1, "graphical": 1, "uncertainty": 1, "rule": 1}, {"mln": 1, "treat": 1, "predicate": 1, "logic": 1, "rule": 1, "latent": 1, "variables": 1, "inference": 1, "task": 1, "get": 1, "posterior": 1}, {"gln": 1, "task": 1, "structure": 1, "prediction": 1, "predicate": 1, "implement": 1, "subgraph": 1, "match": 1}, {"show": 1, "detail": 1, "connection": 1, "appendix": 1}, {"4": 1, "": 2, "model": 2, "design": 2, "although": 1, "define": 1, "far": 1, "nice": 1, "properties": 1, "components": 1, "play": 1, "critical": 1, "role": 1, "capture": 1, "uncertainty": 1, "retrosynthesis": 1}, {"first": 1, "describe": 1, "decomposable": 1, "design": 1, "pt": 1, "sec": 1}, {"41": 1, "learn": 1, "sample": 1, "efficiency": 1, "consideration": 1, "sec": 1}, {"42": 1, "describe": 1, "parameterization": 1, "score": 1, "function": 1, "w1": 1, "": 1, "w2": 1, "detail": 1}, {"41": 1, "": 2, "decomposable": 1, "design": 1, "pt": 1, "depend": 1, "specific": 1, "reaction": 1, "rule": 1, "template": 1, "set": 1, "could": 1, "large": 1, "total": 1, "number": 1, "reactions": 1, "extreme": 1, "case": 1}, {"thus": 1, "directly": 1, "model": 1, "pt": 1, "lead": 1, "difficulties": 1, "learn": 1, "inference": 1}, {"revisit": 1, "logic": 1, "rule": 1, "define": 1, "eq": 1}, {"2": 1, "see": 1, "subgraph": 1, "pattern": 1, "ot": 1, "play": 1, "critical": 1, "role": 1, "choose": 1, "template": 1}, {"since": 1, "represent": 1, "templates": 1, "n": 1, "": 3, "ot": 1}, {"rit": 1, "i1": 1, "": 1, "natural": 1, "decompose": 1, "energy": 1, "function": 1, "w1": 1, "eq": 1}, {"4": 1, "": 8, "n": 1, "w1": 1, "v1": 1, "ot": 1, "v2": 1, "rit": 1, "i1": 1}, {"meanwhile": 1, "recall": 1, "template": 2, "match": 1, "rule": 1, "also": 1, "decomposable": 1, "obtain": 1, "result": 1, "probability": 1, "model": 1, "pt": 1, "": 29, "pot": 1, "rit": 2, "1": 1, "zo": 1, "n": 2, "i1": 2, "exp": 3, "v1": 2, "ot": 1, "2": 2, "v2": 1, "partition": 1, "function": 1, "z": 2, "define": 1, "p": 2, "o2f": 1, "io": 1}, {"": 9, "rit": 1, "n": 1, "i1": 1, "r2pf": 1, "exp": 1, "v2": 1, "r": 1, "io": 1}, {"r": 2, "2": 1, "": 2, "abuse": 1, "notation": 1, "bite": 1, "denote": 1, "set": 1, "subgraph": 1, "pattern": 1}, {"8": 1, "": 6, "2t": 1, "9": 1, "decomposition": 1, "speed": 1, "train": 1, "inference": 1, "pt": 1, "since": 1, "number": 3, "valid": 1, "reaction": 2, "center": 2, "per": 2, "molecule": 1, "templates": 2, "much": 1, "smaller": 1, "total": 1}, {"specifically": 1, "sample": 2, "": 8, "pt": 1, "4": 1, "first": 1, "reaction": 1, "center": 1, "poo": 1, "exp": 2, "v1": 1, "2": 1, "choose": 1, "subgraph": 1, "pattern": 1, "reactants": 1, "pr": 1, "v2": 1, "r": 1, "io": 1}, {"r": 1, "2": 1, "": 1}, {"end": 1, "obtain": 1, "templated": 1, "represent": 1, "": 1}, {"r": 1}, {"literature": 1, "several": 1, "attempt": 1, "model": 2, "learn": 1, "pt": 1, "eg": 1, "multiclass": 1, "classification": 1, "9": 1, "multiscale": 1, "human": 1, "define": 1, "template": 1, "hierarchy": 1, "14": 1}, {"propose": 1, "decomposable": 1, "design": 1, "follow": 1, "template": 1, "specification": 1, "naturally": 1, "thus": 1, "nice": 1, "graph": 1, "structure": 1, "parameterization": 1, "interpretation": 1, "cover": 1, "next": 1, "subsection": 1}, {"finally": 1, "direct": 1, "graphical": 1, "model": 1, "design": 1, "eq": 1}, {"6": 1, "write": 1, "pr": 1, "": 35, "1": 1, "zozto": 1, "zt": 1, "42": 1, "p": 1, "exp": 2, "r2pm": 1, "v1": 1, "ot": 3, "v2": 1, "rit": 1, "w2": 2, "r": 4, "n": 1, "i1": 1, "10": 1, "sum": 1, "subsets": 1, "molecules": 1}, {"graph": 3, "neuralization": 1, "v1": 1, "": 3, "v2": 1, "w2": 2, "since": 1, "arguments": 1, "energy": 1, "function": 1, "w1": 1, "molecules": 1, "represent": 1, "one": 1, "natural": 1, "choice": 1, "design": 1, "parameterization": 1, "base": 1, "recent": 1, "advance": 1, "neural": 1, "network": 1, "gnn": 1, "17": 1, "18": 1, "19": 1, "20": 1, "21": 1, "22": 1}, {"first": 1, "present": 1, "brief": 1, "review": 1, "general": 1, "form": 1, "gnns": 1, "explain": 1, "utilize": 1, "design": 1, "energy": 1, "function": 1}, {"graph": 1, "embed": 1, "function": 1, "g": 1, "": 1, "f": 1, "7": 1}, {"rd": 1, "map": 1, "graph": 1, "ddimensional": 1, "vector": 1}, {"denote": 1, "g": 7, "": 12, "v": 3, "e": 3, "graph": 1, "representation": 1, "molecule": 1, "subgraph": 1, "pattern": 1, "vi": 1, "i1": 2, "set": 2, "atoms": 1, "nod": 1, "ei": 1, "e1i": 1, "e2i": 1, "bond": 1, "edge": 1}, {"represent": 1, "undirected": 1, "bond": 1, "two": 1, "directional": 1, "edge": 1}, {"generally": 1, "embed": 1, "graph": 1, "compute": 2, "node": 1, "embeddings": 1, "hvi": 1, "iterative": 1, "fashion": 1}, {"specifically": 1, "let": 1, "h0vi": 1, "": 1, "xvi": 2, "initially": 1, "vector": 1, "node": 1, "feature": 1, "like": 1, "atomic": 1, "number": 1, "aromaticity": 1, "etc": 1}, {"correspond": 1, "atom": 1}, {"follow": 1, "update": 1, "operator": 1, "apply": 1, "recursively": 1, "hl1": 1, "": 8, "f": 1, "xv": 1, "hlu": 1, "xuv": 2, "v": 2, "u2n": 1, "feature": 1, "edge": 1, "u": 1}, {"v": 1, "": 2, "11": 1, "procedure": 1, "repeat": 1, "l": 1, "step": 1}, {"many": 1, "design": 1, "choices": 1, "socalled": 1, "message": 1, "pass": 1, "operator": 1, "f": 1, "": 1, "use": 1, "structure2vec": 1, "21": 1, "due": 1, "simplicity": 1, "efficient": 1, "c": 1, "bind": 1, "rdkit": 1}, {"finally": 1, "parameterization": 1, "x": 2, "hl1": 1, "": 11, "1": 2, "xv": 1, "2": 1, "hlu": 1, "3": 1, "4": 1, "xuv": 1, "12": 1, "v": 3, "u2n": 2, "nonlinear": 1, "activation": 1, "function": 1, "eg": 1, "relu": 1, "tanh": 1}, {"": 1}, {"": 1}, {"": 2, "4": 1, "learnable": 1, "parameters": 1}, {"let": 1, "node": 2, "embed": 2, "hv": 2, "": 4, "hl": 1, "v": 1, "last": 1, "output": 1, "f": 1, "p": 1, "final": 1, "graph": 1, "obtain": 1, "via": 1, "average": 1, "embeddings": 1, "gg": 1, "v1g": 1, "v2v": 1, "g": 1}, {"note": 1, "attention": 1, "23": 1, "order": 1, "invariant": 1, "aggregation": 2, "also": 1, "use": 1}, {"knowledge": 1, "gnn": 1, "introduce": 1, "concrete": 1, "parametrization": 1, "component": 1, "": 3, "parameterizing": 1, "v1": 2, "give": 1, "molecule": 1, "view": 1, "score": 1, "function": 1, "possible": 1, "reaction": 1, "center": 1, "inside": 1}, {"since": 1, "subgraph": 1, "pattern": 1, "also": 1, "graph": 1, "parameterize": 1, "inner": 1, "product": 1, "ie": 1, "v1": 1, "": 1, "g1": 1, "g2": 1}, {"form": 1, "treat": 1, "compute": 1, "compatibility": 1}, {"note": 1, "due": 1, "design": 1, "choice": 1, "v1": 2, "write": 1, "": 2, "p": 1, "h": 1, "v": 1, "g1": 1}, {"form": 1, "allow": 1, "us": 1, "see": 1, "contribution": 1, "compatibility": 1, "atom": 1, "v2v": 1, "n": 1, "": 5, "parameterizing": 1, "v2": 1, "size": 1, "set": 1, "subgraph": 1, "pattern": 1, "rit": 1, "i1": 1, "vary": 1, "different": 1, "template": 1}, {"inspire": 1, "deepset": 1, "24": 1, "use": 1, "average": 1, "pool": 1, "embeddings": 1, "subgraph": 1, "pattern": 1, "represent": 1, "set": 1}, {"specifically": 1, "0": 1, "1": 2, "n": 3, "": 9, "x": 1, "v2": 1, "rit": 2, "i1": 2, "g3": 1, "g4": 1, "13": 1, "parameterizing": 1, "w2": 1, "energy": 1, "function": 1, "also": 1, "need": 1, "take": 1, "set": 1, "input": 1}, {"follow": 1, "design": 1, "v2": 1, "": 2}, {"1": 1, "x": 1, "": 3, "w2": 1, "r": 2, "g5": 1, "g6": 1}, {"14": 1, "r": 1, "r2r": 1, "": 2, "5": 1, "note": 1, "gln": 1, "framework": 1, "isnt": 1, "limit": 1, "specific": 1, "parameterization": 1, "compatible": 1, "parametrizations": 1}, {"example": 1, "one": 1, "use": 1, "condense": 1, "graph": 2, "reaction": 1, "25": 1, "represent": 1, "r": 1, "single": 1}, {"chemistry": 1, "specialize": 1, "gnns": 1, "3": 1, "26": 1, "also": 1, "easily": 1, "apply": 1}, {"ablation": 1, "study": 1, "design": 1, "choices": 1, "please": 1, "refer": 1, "appendix": 1, "c1": 1}, {"5": 1, "": 10, "mle": 1, "efficient": 1, "inference": 1, "give": 1, "dataset": 1, "oi": 1, "ti": 1, "ri": 1, "i1": 1, "reactions": 1, "denote": 1, "parameters": 1, "w1": 1, "w2": 1, "r": 1, "1": 1, "2": 1, "respectively": 1}, {"maximum": 1, "loglikelihood": 1, "estimation": 2, "mle": 1, "natural": 1, "choice": 1, "parameter": 1}, {"since": 1, "8": 1, "r": 3, "": 15, "1": 2, "ot": 1, "mle": 1, "optimization": 1, "b": 2, "log": 3, "p": 2, "rt": 1, "max": 1, "e": 2, "15": 1, "w1": 1, "w2": 1, "z": 2, "gradient": 1, "wrt": 1}, {"": 10, "derived4": 1, "b": 4, "r": 7, "w1": 2, "e": 4, "et": 2, "w2": 2, "16": 1, "ot": 1, "erto": 1, "erot": 1, "stand": 1, "expectation": 1, "wrt": 1}, {"current": 1, "model": 1, "p": 2, "r": 1, "respectively": 1}, {"gradient": 2, "estimator": 1, "16": 1, "apply": 1, "stochastic": 1, "descent": 1, "sgd": 1, "algorithm": 1, "optimize": 1, "15": 1}, {"efficient": 1, "inference": 1, "gradient": 1, "approximation": 1, "since": 1, "r": 1, "2": 1, "pm": 1, "combinatorial": 1, "space": 1, "generally": 1, "expensive": 1, "mcmc": 1, "algorithm": 1, "require": 1, "sample": 1, "p": 1, "rt": 1, "approximate": 1, "16": 1}, {"however": 1, "largely": 1, "accelerate": 1, "scrutinize": 1, "logic": 1, "property": 1, "propose": 1, "model": 1}, {"recall": 1, "match": 1, "template": 1, "reactants": 1, "necessary": 1, "condition": 1, "p": 1, "r": 1, "0": 1, "design": 1}, {"hand": 1, "give": 1, "templates": 1, "reactants": 1, "r": 2, "nonzero": 1, "": 1, "ot": 1}, {"sample": 2, "r": 1, "importance": 1, "restrict": 1, "support": 1, "templates": 1, "instead": 1, "mcmc": 1, "p": 1}, {"rigorously": 1, "give": 1, "denote": 1, "match": 2, "templates": 1, "reactants": 1, "base": 1, "rto": 2, "": 13, "6": 2, "0": 2, "8t": 1, "2": 2, "r": 4, "ot": 1, "8r": 1, "p": 1, "17": 1, "importance": 2, "sample": 2, "lead": 1, "b": 2, "algorithm": 2, "1": 2, "unbiased": 1, "gradient": 1, "approximation": 1, "illustrate": 1}, {"make": 1, "1": 1, "input": 1, "r": 1, "": 1, "p": 2, "rt": 1}, {"algorithm": 1, "efficient": 1, "practice": 1, "2": 1, "construct": 1, "accord": 1, "": 1}, {"adopt": 1, "follow": 1, "accelerations": 1, "3": 1, "sample": 1, "": 2, "exp": 1, "w1": 1, "8t": 1, "2": 1, "hierarchical": 1, "way": 1, "sec": 1}, {"41": 1}, {"": 1, "1": 1, "decomposable": 1, "model": 1, "pt": 1, "4": 1, "construct": 1, "rto": 1, "accord": 1, "ot": 1, "r": 1}, {"describe": 1, "sec": 1}, {"41": 1, "": 2, "2": 1, "cache": 1, "compute": 1, "r": 3, "5": 1, "sample": 1, "exp": 1, "w2": 1}, {"advance": 1}, {"b": 1, "": 8, "6": 1, "compute": 1, "r": 3, "stochastic": 1, "approximation": 1, "4": 1, "dataset": 1, "5": 1, "10": 1, "reactions": 1, "sample": 1, "16": 1}, {"80": 1, "rto": 1, "": 1, "roughly": 1, "10": 1, "average": 1}, {"therefore": 1, "reduce": 1, "actual": 1, "computational": 1, "cost": 1, "manageable": 1, "constant": 1}, {"reduce": 1, "computation": 1, "cost": 1, "sample": 1, "generate": 1, "r": 1, "uniformly": 1, "support": 1}, {"although": 1, "sample": 1, "cover": 1, "support": 1, "model": 1, "avoid": 1, "calculation": 1, "forward": 1, "pass": 1, "neural": 1, "network": 1, "achieve": 1, "better": 1, "computational": 1, "complexity": 1}, {"experiment": 1, "approximation": 1, "already": 1, "achieve": 1, "stateoftheart": 1, "result": 1}, {"would": 2, "expect": 1, "recent": 1, "advance": 1, "energy": 1, "base": 1, "model": 1, "boost": 1, "performance": 1, "leave": 1, "future": 1, "work": 1, "investigate": 1}, {"remark": 1, "rto": 1, "": 1, "note": 1, "get": 1, "possible": 1, "set": 1, "reactants": 2, "match": 1, "reaction": 1, "template": 1, "product": 1, "efficiently": 1, "use": 1, "graph": 1, "edit": 1, "tool": 1, "without": 1, "limit": 1, "know": 1, "dataset": 1}, {"procedure": 1, "work": 1, "follow": 1, "give": 1, "template": 1, "": 2, "ot": 1}, {"r1t": 1, "": 2}, {"": 1}, {"": 1}, {"": 4, "rn": 1, "1": 1, "enumerate": 1, "match": 1, "subgraph": 1, "pattern": 1, "ot": 1, "target": 1, "product": 1, "2": 1, "instantiate": 1, "copy": 1, "reactant": 1, "atoms": 1, "accord": 1, "r1t": 1}, {"": 1}, {"": 1}, {"": 1, "rn": 1, "match": 1}, {"3": 1, "copy": 1, "connect": 1, "atoms": 1, "atom": 1, "properties": 1}, {"4": 1, "": 3, "adopt": 1, "conventions": 1, "0": 3, "log": 2, "27": 1, "justify": 1, "continuity": 1, "since": 1, "x": 2}, {"0": 1, "x": 1, "": 1}, {"0": 1}, {"6": 1, "": 1, "process": 1, "routine": 1, "cheminformatics": 1, "package": 1}, {"paper": 1, "use": 1, "runreactants": 1, "rdkit": 1, "improvement": 1, "stereochemistry": 1, "handle": 1, "5": 1, "realize": 1}, {"acceleration": 1, "via": 1, "beam": 1, "search": 1, "give": 1, "product": 1, "prediction": 1, "involve": 1, "find": 1, "pair": 1, "r": 1, "": 1, "maximize": 1, "pr": 1}, {"one": 1, "possibility": 1, "first": 1, "enumerate": 1, "2": 2, "r": 1, "rto": 1, "": 1}, {"acceptable": 1, "exploit": 1, "sparse": 1, "support": 1, "property": 1, "induce": 1, "logic": 1, "rule": 1}, {"efficient": 1, "way": 1, "use": 1, "beam": 1, "search": 1, "size": 1, "k": 2, "firstly": 1, "find": 1, "reaction": 1, "center": 1, "oi": 1, "ki1": 1, "top": 1, "v1": 1}, {"next": 1, "2": 1, "oi": 1, "ki1": 1, "score": 1, "correspond": 1, "v2": 1, "r": 1, "": 3}, {"r": 1, "2": 1, "": 1}, {"stage": 1, "top": 1, "k": 1, "pair": 1, "otj": 1, "": 3, "ri": 1, "j": 1, "kj1": 1, "ie": 1, "templates": 1, "maximize": 1, "v1": 1, "oo": 1, "sk": 1, "v2": 1, "r": 1, "keep": 1}, {"finally": 1, "use": 1, "templates": 1, "choose": 1, "best": 1, "r": 2, "2": 1, "j1": 1, "rtj": 1, "maximize": 1, "total": 1, "score": 1, "w1": 1, "": 1, "w2": 1}, {"fig": 1}, {"2": 1, "provide": 1, "visual": 1, "explanation": 1}, {"6": 1, "": 2, "experiment": 1, "dataset": 2, "mainly": 1, "evaluate": 1, "method": 1, "benchmark": 1, "name": 1, "uspto50k": 1, "contain": 1, "50k": 1, "reactions": 1, "10": 1, "different": 1, "type": 1, "us": 1, "patent": 1, "literature": 1}, {"use": 1, "exactly": 1, "trainingvalidationtest": 1, "split": 1, "coley": 1, "et": 1, "al": 1}, {"8": 1, "contain": 1, "801010": 1, "total": 1, "50k": 1, "reactions": 1}, {"table": 1, "1": 1, "contain": 1, "detail": 1, "information": 1, "benchmark": 1}, {"additionally": 1, "also": 1, "build": 1, "dataset": 1, "entire": 1, "uspto": 1, "19762016": 1, "verify": 1, "scalability": 1, "method": 1}, {"baselines": 1, "baseline": 1, "algorithms": 1, "consist": 1, "rulebased": 1, "ones": 2, "neural": 1, "networkbased": 1}, {"expertsys": 1, "expert": 1, "system": 1, "base": 1, "retrosynthetic": 1, "reaction": 2, "rule": 2, "select": 1, "accord": 1, "popularity": 1, "correspond": 1, "type": 1}, {"seq2seq": 1, "10": 1, "transformer": 2, "11": 1, "neural": 1, "sequencetosequencebased": 1, "learn": 1, "model": 1, "28": 1, "implement": 1, "lstm": 1, "29": 1, "30": 1}, {"model": 1, "encode": 1, "canonicalized": 1, "smile": 2, "representation": 1, "target": 1, "compound": 1, "input": 1, "directly": 1, "output": 1, "canonical": 1, "reactants": 1}, {"also": 1, "include": 1, "datadriven": 1, "templatebased": 1, "model": 1}, {"retrosim": 1, "8": 1, "use": 1, "direct": 1, "calculation": 1, "molecular": 1, "similarities": 1, "rank": 1, "rule": 1, "result": 1, "reactants": 1}, {"neuralsym": 1, "9": 1, "model": 1, "pt": 1, "multiclass": 1, "classification": 1, "use": 1, "mlp": 1}, {"result": 1, "except": 1, "neuralsym": 1, "obtain": 1, "original": 1, "report": 1, "since": 1, "experiment": 1, "set": 1}, {"since": 1, "neuralsym": 1, "opensource": 1, "reimplemented": 1, "use": 1, "best": 1, "report": 1, "elu512": 1, "model": 1, "method": 1, "parameter": 1, "tune": 1}, {"evaluation": 2, "metric": 2, "use": 2, "topk": 1, "exact": 1, "match": 1, "accuracy": 1, "commonly": 1, "literature": 1}, {"metric": 1, "compare": 1, "whether": 1, "predict": 1, "set": 1, "reactants": 2, "exactly": 1, "grind": 1, "truth": 1}, {"comparison": 1, "perform": 1, "canonical": 1, "smile": 1, "string": 1, "generate": 1, "rdkit": 1}, {"setup": 1, "gln": 1, "use": 1, "rdchiral": 1, "31": 1, "extract": 1, "retrosynthesis": 1, "templates": 1, "train": 1, "set": 1}, {"remove": 1, "duplicate": 1, "obtain": 1, "11647": 1, "unique": 1, "template": 1, "rule": 1, "total": 1, "uspto50k": 1}, {"rule": 1, "represent": 1, "933": 1, "coverage": 1, "test": 1, "set": 1}, {"say": 1, "test": 1, "instance": 1, "try": 1, "apply": 1, "rule": 2, "see": 1, "give": 1, "exact": 1, "match": 1}, {"thus": 1, "theoretical": 1, "upper": 1, "bind": 1, "rulebased": 1, "approach": 1, "use": 1, "particular": 1, "degree": 1, "specificity": 1, "high": 1, "enough": 1}, {"information": 1, "statistics": 1, "rule": 1, "please": 1, "refer": 1, "table": 1, "2": 1}, {"train": 1, "model": 1, "150k": 1, "update": 1, "batch": 1, "size": 1, "64": 1}, {"take": 1, "12": 1, "hours": 1, "train": 1, "single": 1, "gtx": 1, "1080ti": 1, "gpu": 1}, {"tune": 1, "embed": 1, "size": 1, "128": 1, "256": 1, "gnn": 2, "layer": 1, "3": 1, "4": 1, "5": 1, "aggregation": 1, "max": 1, "mean": 1, "sum": 1, "use": 1, "validation": 1, "set": 1}, {"code": 1, "release": 1, "httpsgithubcomhanjundaigln": 1}, {"detail": 1, "include": 1, "appendix": 1, "b": 1}, {"61": 1, "": 2, "main": 1, "result": 1, "present": 1, "topk": 1, "exact": 1, "match": 1, "accuracy": 1, "table": 1, "3": 2, "k": 1, "range": 1, "1": 1, "5": 1, "10": 1, "20": 1, "50": 1}, {"evaluate": 1, "reaction": 1, "class": 2, "unknown": 1, "conditional": 1, "settings": 1}, {"use": 1, "reaction": 1, "class": 1, "prior": 1, "knowledge": 1, "represent": 1, "situations": 1, "chemists": 1, "already": 1, "idea": 1, "would": 1, "like": 1, "synthesize": 1, "product": 1}, {"settings": 1, "propose": 1, "gln": 1, "outperform": 1, "baseline": 1, "algorithms": 1}, {"particularly": 1, "top1": 1, "accuracy": 2, "model": 1, "perform": 1, "significantly": 1, "better": 1, "second": 1, "best": 1, "method": 1, "81": 1, "higher": 2, "unknown": 1, "reaction": 2, "class": 2, "89": 1, "give": 1}, {"demonstrate": 1, "advantage": 1, "method": 1, "difficult": 1, "set": 1, "potential": 1, "applicability": 1, "reality": 1}, {"5": 1, "": 1, "httpsgithubcomconnorcoleyrdchiral": 1}, {"7": 1, "": 25, "uspto": 1, "50k": 1, "train": 1, "val": 1, "test": 1, "rule": 1, "reaction": 2, "type": 1, "topk": 1, "accuracy": 1, "40008": 1, "5001": 1, "5007": 1, "11647": 1, "10": 2, "methods": 1, "3": 1, "5": 1, "20": 1, "50": 1, "741": 1, "789": 1, "837": 1, "820": 1, "822": 1, "890": 1, "853": 1, "831": 1, "924": 1, "686": 1, "659": 1, "918": 1, "865": 1, "923": 1, "695": 1, "707": 1, "929": 1, "869": 1, "932": 1, "class": 1, "unknown": 1, "transformer11": 1, "retrosim8": 1, "neuralsym9": 1, "gln": 1, "table": 1, "1": 1, "dataset": 1, "information": 1}, {"rule": 1, "coverage": 1, "": 1, "unique": 1, "center": 1, "avg": 1}, {"": 1, "center": 1, "per": 1, "mol": 1, "avg": 1}, {"": 1, "rule": 1, "per": 1, "mol": 1, "avg": 1}, {"": 8, "reactants": 1, "1": 1, "379": 1, "373": 1, "444": 1, "525": 1, "573": 1, "547": 1, "653": 1, "690": 1, "627": 1, "633": 1, "724": 1, "756": 1, "reaction": 2, "class": 1, "give": 1, "prior": 1, "933": 1, "9078": 1, "2931": 1, "8385": 1, "171": 1, "expertsys10": 1, "seq2seq10": 1, "retrosim8": 1, "neuralsym9": 1, "gln": 1, "table": 1, "2": 1, "template": 1, "set": 1, "information": 1}, {"354": 1, "374": 1, "529": 1, "553": 1, "642": 1, "": 4, "523": 1, "524": 1, "738": 1, "760": 1, "791": 1, "591": 1, "570": 1, "812": 1, "814": 1, "852": 1, "651": 1, "617": 1, "881": 1, "851": 1, "900": 1, "table": 1, "3": 1, "topk": 1, "exact": 1, "match": 1, "accuracy": 1}, {"cl": 16, "": 215, "nh": 33, "2": 4, "grind": 2, "truth": 2, "f": 16, "n": 37, "h": 6, "oh": 6, "similarity09": 2, "similarity082": 2, "correct": 1, "similarity087": 1, "nh2": 2, "figure": 1, "3": 1, "example": 1, "successful": 1, "predictions": 1}, {"figure": 1, "4": 1, "example": 1, "fail": 1, "predictions": 1}, {"moreover": 1, "performance": 1, "reaction": 2, "class": 1, "unknown": 1, "set": 2, "even": 1, "outperform": 1, "expertsys": 1, "seq2seq": 1, "conditional": 1}, {"since": 1, "transformer": 1, "paper": 1, "didnt": 1, "report": 1, "topk": 1, "performance": 1, "k": 1, "": 1, "10": 1, "leave": 1, "blank": 1}, {"meanwhile": 1, "karpov": 1, "et": 1, "al": 1}, {"11": 1, "also": 1, "report": 1, "result": 1, "train": 1, "use": 1, "trainingvalidation": 1, "set": 2, "tune": 1, "test": 1}, {"extra": 1, "priviledge": 1, "top1": 1, "accuracy": 1, "transformer": 1, "427": 1, "still": 1, "worse": 1, "performance": 1}, {"show": 1, "benefit": 1, "logic": 1, "power": 1, "deep": 1, "neural": 2, "network": 1, "model": 2, "compare": 1, "purely": 1, "especially": 1, "amount": 1, "data": 1, "limit": 1}, {"since": 1, "theoretical": 1, "upper": 1, "bind": 1, "rulebased": 1, "implementation": 1, "933": 1, "top50": 1, "accuracy": 1, "method": 1, "set": 1, "quite": 1, "close": 1, "limit": 1}, {"show": 1, "probabilistic": 1, "model": 1, "build": 1, "match": 1, "actual": 1, "retrosynthesis": 1, "target": 1, "well": 1}, {"62": 1, "": 2, "interpret": 1, "predictions": 1, "visualize": 2, "predict": 2, "synthesis": 1, "fig": 1, "3": 2, "4": 1, "grind": 1, "truth": 1, "reaction": 1, "top": 1, "reactions": 1, "see": 1, "appendix": 1, "c6": 1, "high": 1, "resolution": 1, "figure": 1}, {"reaction": 2, "also": 1, "highlight": 1, "correspond": 1, "core": 1, "ie": 1, "set": 1, "atoms": 1, "get": 1, "change": 1}, {"do": 1, "match": 1, "subgraphs": 1, "predict": 1, "retrosynthesis": 1, "template": 1, "target": 1, "compound": 1, "generate": 1, "reactants": 1, "respectively": 1}, {"fig": 1, "3": 1, "show": 1, "correct": 1, "prediction": 1, "also": 1, "get": 1, "almost": 1, "reaction": 1, "core": 1, "predict": 1, "grind": 1, "truth": 1}, {"particular": 1, "case": 1, "explanation": 1, "prediction": 1, "align": 1, "exist": 1, "reaction": 1, "knowledge": 1}, {"fig": 1, "4": 1, "show": 1, "failure": 1, "mode": 1, "none": 1, "top3": 1, "prediction": 1, "match": 1}, {"case": 1, "calculate": 1, "similarity": 2, "predict": 1, "reactants": 1, "grind": 1, "truth": 1, "ones": 1, "use": 1, "dice": 1, "rdkit": 1}, {"find": 1, "still": 1, "similar": 1, "molecule": 1, "fingerprint": 1, "level": 1, "suggest": 1, "predictions": 1, "could": 1, "potentially": 1, "valid": 1, "unknown": 1, "ones": 1, "literature": 1}, {"8": 1, "": 9, "bottom1": 2, "prediction": 5, "true": 2, "reaction": 3, "core": 2, "top1": 2, "center": 2, "molecules": 1, "figure": 1, "5": 1, "visualization": 1}, {"red": 1, "atoms": 1, "indicate": 1, "positive": 1, "match": 1, "score": 2, "blue": 1, "ones": 1, "negative": 1}, {"darkness": 1, "color": 1, "show": 1, "magnitude": 1, "score": 1}, {"green": 1, "part": 1, "highlight": 1, "substructure": 1, "match": 1, "molecules": 1, "center": 1, "structure": 1}, {"visualize": 2, "reaction": 2, "center": 2, "prediction": 2, "probabilistic": 1, "model": 1}, {"do": 1, "calculate": 1, "inner": 1, "product": 1, "atom": 1, "embed": 2, "target": 1, "molecule": 1, "subgraph": 1, "pattern": 1}, {"fig": 1, "5": 1, "show": 1, "visualization": 1, "score": 1, "atoms": 1, "part": 1, "reaction": 1, "center": 1}, {"top1": 1, "prediction": 3, "assign": 2, "positive": 1, "score": 2, "atoms": 1, "red": 1, "ones": 2, "bottom1": 1, "ie": 1, "least": 1, "probability": 1, "large": 1, "negative": 1, "blue": 1}, {"note": 1, "although": 1, "reaction": 1, "center": 1, "molecule": 1, "correspond": 1, "subgraph": 1, "pattern": 1, "structure": 1, "match": 1, "score": 1, "differ": 1, "lot": 1}, {"suggest": 1, "model": 1, "learn": 1, "predict": 1, "activity": 1, "substructures": 1, "inside": 1, "molecule": 1, "graph": 1}, {"63": 1, "": 2, "study": 2, "performance": 1, "addition": 1, "overall": 1, "number": 1, "table": 1, "3": 1, "provide": 1, "detail": 1, "performances": 1}, {"include": 1, "percategory": 1, "performance": 1, "accuracy": 1, "module": 1, "hierarchical": 1, "sample": 1, "also": 1, "effect": 1, "beam": 1, "size": 1}, {"due": 1, "space": 1, "limit": 1, "please": 1, "refer": 1, "appendix": 1, "c": 1, "64": 1, "": 5, "large": 2, "scale": 2, "experiment": 1, "usptofull": 1, "top1": 1, "top10": 1, "retrosim": 1, "328": 1, "561": 1, "neuralsym": 1, "358": 1, "608": 1, "gln": 1, "393": 1, "637": 1, "see": 1, "method": 1, "dataset": 2, "size": 1, "create": 1, "entire": 1, "set": 1, "reactions": 1, "uspto": 1, "19762016": 1}, {"table": 1, "4": 1, "topk": 1, "accuracy": 1, "usptofull": 1}, {"1808937": 1, "raw": 1, "reactions": 1, "total": 1}, {"reactions": 1, "multiple": 2, "products": 1, "duplicate": 1, "ones": 1, "one": 1, "product": 1}, {"remove": 1, "duplications": 1, "reactions": 2, "wrong": 1, "atom": 1, "mappings": 1, "obtain": 1, "roughly": 1, "1m": 1, "unique": 1, "divide": 1, "trainvalidtest": 1, "set": 1, "size": 1, "800k100k100k": 1}, {"train": 1, "single": 1, "gpu": 1, "3": 1, "days": 1, "report": 1, "model": 1, "best": 1, "validation": 1, "accuracy": 1}, {"result": 1, "present": 1, "table": 1, "4": 1}, {"compare": 1, "best": 1, "two": 1, "baselines": 1, "previous": 1, "section": 1}, {"despite": 1, "noisiness": 1, "full": 1, "uspto": 1, "set": 1, "relative": 1, "clean": 1, "uspto50k": 1, "method": 1, "still": 1, "outperform": 1, "two": 1, "best": 1, "baselines": 1, "topk": 1, "accuracies": 1}, {"7": 1, "": 2, "discussion": 1, "evaluation": 1, "retrosynthesis": 1, "usually": 1, "single": 1, "right": 1, "answer": 1}, {"evaluation": 1, "work": 1, "reproduce": 1, "report": 1, "singlestep": 1, "retrosynthesis": 1}, {"good": 1, "imperfect": 1, "benchmark": 1, "since": 1, "potentially": 1, "many": 1, "reasonable": 1, "ways": 1, "synthesize": 1, "single": 1, "product": 1}, {"limitations": 2, "share": 1, "templatebased": 1, "methods": 1}, {"method": 1, "template": 1, "design": 2, "specifically": 1, "specificities": 1, "remain": 1, "art": 1, "hard": 1, "decide": 1, "beforehand": 1}, {"also": 1, "scalability": 1, "still": 1, "issue": 1, "since": 1, "rely": 1, "subgraph": 1, "isomorphism": 1, "preprocessing": 1}, {"future": 1, "work": 1, "subgraph": 1, "isomorphism": 1, "part": 1, "potentially": 1, "replace": 1, "predictive": 1, "model": 1, "inference": 1, "fast": 1, "inner": 1, "product": 1, "search": 1, "32": 1, "use": 1, "reduce": 1, "computation": 1, "cost": 1}, {"also": 1, "actively": 1, "build": 1, "templates": 1, "even": 1, "induce": 1, "new": 1, "ones": 1, "could": 1, "enhance": 1, "capacity": 1, "robustness": 1}, {"acknowledgments": 1, "would": 1, "like": 1, "thank": 1, "anonymous": 1, "reviewers": 1, "provide": 1, "constructive": 1, "feedbacks": 1}, {"project": 1, "support": 1, "part": 1, "nsf": 1, "grant": 1, "cdse1900017": 1, "d3sc": 1, "ccf1836936": 1, "fmitf": 1, "iis1841351": 1, "career": 1, "iis1350983": 1, "ls": 1}, {"9": 1, "": 1, "reference": 1, "1": 1, "elias": 1, "jam": 1, "corey": 1}, {"logic": 1, "chemical": 1, "synthesis": 2, "multistep": 1, "complex": 1, "carbogenic": 1, "molecules": 1, "nobel": 1, "lecture": 1}, {"angewandte": 1, "chemie": 1, "international": 1, "edition": 1, "english": 1, "305455465": 1, "1991": 1}, {"2": 1, "connor": 1, "w": 1, "coley": 1, "william": 1, "h": 1, "green": 1, "klavs": 1, "f": 1, "jensen": 1}, {"machine": 1, "learn": 1, "computeraided": 1, "synthesis": 1, "plan": 1}, {"51512811289": 1, "": 1}, {"doi": 1, "101021acsaccounts8b00087": 1}, {"3": 1, "wengong": 1, "jin": 1, "connor": 1, "coley": 1, "regina": 1, "barzilay": 1, "tommi": 1, "jaakkola": 1}, {"predict": 1, "organic": 1, "reaction": 1, "outcomes": 1, "weisfeilerlehman": 1, "network": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "26072616": 1, "2017": 1}, {"4": 1, "connor": 1, "w": 1, "coley": 1, "wengong": 1, "jin": 1, "luke": 1, "rogers": 1, "timothy": 1, "f": 2, "jamison": 1, "tommi": 1, "jaakkola": 1, "william": 1, "h": 1, "green": 1, "regina": 1, "barzilay": 1, "klavs": 1, "jensen": 1}, {"graphconvolutional": 1, "neural": 1, "network": 1, "model": 1, "prediction": 1, "chemical": 1, "reactivity": 1}, {"102370377": 1, "": 1}, {"doi": 1, "101039c8sc04228d": 1}, {"5": 1, "john": 1, "bradshaw": 1, "matt": 1, "j": 1, "kusner": 1, "brook": 1, "paige": 1, "marwin": 1, "hs": 1, "segler": 1, "jos": 1, "miguel": 1, "hernndezlobato": 1}, {"generative": 1, "model": 1, "electron": 1, "paths": 1}, {"2018": 1}, {"6": 1, "ej": 1, "corey": 1, "w": 1, "todd": 1, "wipke": 1}, {"computerassisted": 1, "design": 1, "complex": 1, "organic": 1, "syntheses": 1}, {"science": 1, "166": 1, "3902178192": 1, "1969": 1}, {"7": 1, "sara": 1, "szymkuc": 1, "ewa": 1, "p": 1, "gajewska": 1, "tomasz": 1, "klucznik": 1, "karol": 1, "molga": 1, "piotr": 1, "dittwald": 1, "micha": 2, "startek": 1, "bajczyk": 1, "bartosz": 1, "grzybowski": 1}, {"computerassisted": 1, "synthetic": 1, "plan": 1, "end": 1, "begin": 1}, {"55": 1, "2059045937": 1}, {"doi": 1, "101002anie201506101": 1}, {"8": 1, "connor": 1, "w": 1, "coley": 1, "luke": 1, "rogers": 1, "william": 1, "h": 1, "green": 1, "klavs": 1, "f": 1, "jensen": 1}, {"computerassisted": 1, "retrosynthesis": 1, "base": 1, "molecular": 1, "similarity": 1}, {"acs": 1, "central": 1, "science": 1, "31212371245": 1, "2017": 1}, {"9": 1, "marwin": 1, "h": 1, "segler": 1, "mark": 1, "p": 1, "waller": 1}, {"neuralsymbolic": 1, "machine": 1, "learn": 1, "retrosynthesis": 1, "reaction": 1, "prediction": 1}, {"232559665971": 1}, {"doi": 1, "101002chem201605499": 1}, {"10": 1, "bowen": 1, "liu": 1, "bharath": 1, "ramsundar": 1, "prasad": 1, "kawthekar": 1, "jade": 1, "shi": 1, "joseph": 1, "gomes": 1, "quang": 1, "luu": 1, "nguyen": 1, "stephen": 1, "ho": 1, "jack": 1, "sloane": 1, "paul": 1, "wender": 1, "vijay": 1, "pande": 1}, {"retrosynthetic": 1, "reaction": 1, "prediction": 1, "use": 1, "neural": 1, "sequencetosequence": 1, "model": 1}, {"acs": 1, "central": 1, "science": 1, "31011031113": 1, "2017": 1}, {"11": 1, "pavel": 1, "karpov": 1, "guillaume": 1, "godin": 1, "tetko": 1}, {"transformer": 1, "model": 1, "retrosynthesis": 1}, {"2019": 1}, {"12": 1, "philippe": 1, "schwaller": 1, "theophile": 1, "gaudin": 1, "david": 1, "lanyi": 1, "costas": 1, "bekas": 1, "teodoro": 1, "laino": 1}, {"find": 1, "translation": 1, "predict": 1, "outcomes": 1, "complex": 1, "organic": 1, "chemistry": 1, "reactions": 1, "use": 1, "neural": 1, "sequencetosequence": 1, "model": 1}, {"chemical": 1, "science": 1, "92860916098": 1, "2018": 1}, {"13": 1, "philippe": 1, "schwaller": 1, "teodoro": 1, "laino": 1, "theophile": 1, "gaudin": 1, "peter": 1, "bolgar": 1, "costas": 1, "bekas": 1, "alpha": 1, "lee": 1}, {"molecular": 1, "transformer": 1, "chemical": 1, "reaction": 1, "prediction": 1, "uncertainty": 1, "estimation": 1}, {"doi": 1, "1026434chemrxiv": 1}, {"7297379v1": 1}, {"14": 1, "javier": 1, "l": 1, "baylon": 1, "nicholas": 1, "cilfone": 1, "jeffrey": 1, "r": 1, "gulcher": 1, "thomas": 1, "w": 1, "chittenden": 1}, {"enhance": 1, "retrosynthetic": 1, "reaction": 2, "prediction": 1, "deep": 1, "learn": 1, "use": 1, "multiscale": 1, "classification": 1}, {"592": 1, "673688": 1}, {"15": 1, "marwin": 1, "hs": 1, "segler": 1, "mike": 1, "preuss": 1, "mark": 1, "p": 1, "waller": 1}, {"plan": 1, "chemical": 1, "syntheses": 1, "deep": 1, "neural": 1, "network": 1, "symbolic": 1, "ai": 1}, {"nature": 1, "5557698604": 1, "2018": 1}, {"16": 1, "john": 1, "schreck": 1, "connor": 1, "w": 1, "coley": 1, "kyle": 1, "jm": 1, "bishop": 1}, {"learn": 1, "retrosynthetic": 1, "plan": 1, "selfplay": 1}, {"arxiv": 1, "preprint": 1, "arxiv190106569": 1, "2019": 1}, {"17": 1, "franco": 1, "scarselli": 1, "marco": 1, "gori": 1, "ah": 1, "chung": 1, "tsoi": 1, "markus": 1, "hagenbuchner": 1, "gabriele": 1, "monfardini": 1}, {"graph": 1, "neural": 1, "network": 1, "model": 1}, {"ieee": 1, "transactions": 1, "neural": 1, "network": 1, "2016180": 1, "2008": 1}, {"18": 1, "david": 1, "k": 1, "duvenaud": 1, "dougal": 1, "maclaurin": 1, "jorge": 1, "iparraguirre": 1, "rafael": 1, "bombarell": 1, "timothy": 1, "hirzel": 1, "aln": 1, "aspuruguzik": 1, "ryan": 1, "p": 1, "adams": 1}, {"convolutional": 1, "network": 1, "graph": 1, "learn": 1, "molecular": 1, "fingerprint": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "22242232": 1, "2015": 1}, {"19": 1, "tao": 1, "lei": 1, "wengong": 1, "jin": 1, "regina": 1, "barzilay": 1, "tommi": 1, "jaakkola": 1}, {"derive": 1, "neural": 1, "architectures": 1, "sequence": 1, "graph": 1, "kernels": 1}, {"proceed": 1, "34th": 1, "international": 1, "conference": 1, "machine": 1, "learningvolume": 1, "70": 1, "page": 1, "20242033": 1}, {"jmlr": 1}, {"org": 1, "2017": 1}, {"20": 1, "yujia": 1, "li": 1, "daniel": 1, "tarlow": 1, "marc": 1, "brockschmidt": 1, "richard": 1, "zemel": 1}, {"gate": 1, "graph": 1, "sequence": 1, "neural": 1, "network": 1}, {"arxiv": 1, "preprint": 1, "arxiv151105493": 1, "2015": 1}, {"10": 1, "": 1, "21": 1, "hanjun": 1, "dai": 2, "bo": 1, "le": 1, "song": 1}, {"discriminative": 1, "embeddings": 1, "latent": 1, "variable": 1, "model": 1, "structure": 1, "data": 1}, {"international": 1, "conference": 1, "machine": 1, "learn": 1, "page": 1, "27022711": 1, "2016": 1}, {"22": 1, "hamilton": 1, "zhitao": 1, "ying": 1, "jure": 1, "leskovec": 1}, {"inductive": 1, "representation": 1, "learn": 1, "large": 1, "graph": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "10241034": 1, "2017": 1}, {"23": 1, "petar": 1, "velickovic": 1, "guillem": 1, "cucurull": 1, "arantxa": 1, "casanova": 1, "adriana": 1, "romero": 1, "pietro": 1, "lio": 1, "yoshua": 1, "bengio": 1}, {"graph": 1, "attention": 1, "network": 1}, {"arxiv": 1, "preprint": 1, "arxiv171010903": 1, "2017": 1}, {"24": 1, "manzil": 1, "zaheer": 1, "satwik": 1, "kottur": 1, "siamak": 1, "ravanbakhsh": 1, "barnabas": 1, "poczos": 1, "ruslan": 1, "r": 1, "salakhutdinov": 1, "alexander": 1, "j": 1, "smola": 1}, {"deep": 1, "set": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "33913401": 1, "2017": 1}, {"25": 1, "frank": 1, "hoonakker": 1, "nicolas": 1, "lachiche": 1, "alexandre": 1, "varnek": 1, "alain": 1, "wagner": 1}, {"condense": 1, "graph": 1, "reaction": 2, "consider": 1, "chemical": 1, "one": 1, "single": 1, "pseudo": 1, "molecule": 1}, {"26": 1, "justin": 1, "gilmer": 1, "samuel": 1, "schoenholz": 1, "patrick": 1, "f": 1, "riley": 1, "oriol": 1, "vinyals": 1, "george": 1, "e": 1, "dahl": 1}, {"neural": 1, "message": 1, "pass": 1, "quantum": 1, "chemistry": 1}, {"proceed": 1, "34th": 1, "international": 1, "conference": 1, "machine": 1, "learningvolume": 1, "70": 1, "page": 1, "12631272": 1}, {"jmlr": 1}, {"org": 1, "2017": 1}, {"27": 1, "thomas": 2, "cover": 1, "joy": 1}, {"elements": 1, "information": 1, "theory": 1}, {"john": 1, "wiley": 1, "": 1, "sons": 1, "2012": 1}, {"28": 1, "ilya": 1, "sutskever": 1, "oriol": 1, "vinyals": 1, "quoc": 1, "v": 1, "le": 1}, {"sequence": 2, "learn": 1, "neural": 1, "network": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "31043112": 1, "2014": 1}, {"29": 1, "sepp": 1, "hochreiter": 1, "jrgen": 1, "schmidhuber": 1}, {"long": 1, "shortterm": 1, "memory": 1}, {"neural": 1, "computation": 1, "9817351780": 1, "1997": 1}, {"30": 1, "ashish": 1, "vaswani": 1, "noam": 1, "shazeer": 1, "niki": 1, "parmar": 1, "jakob": 1, "uszkoreit": 1, "llion": 1, "jones": 1, "aidan": 1, "n": 1, "gomez": 1, "ukasz": 1, "kaiser": 1, "illia": 1, "polosukhin": 1}, {"attention": 1, "need": 1}, {"advance": 1, "neural": 1, "information": 1, "process": 1, "systems": 1, "page": 1, "59986008": 1, "2017": 1}, {"31": 1, "connor": 1, "w": 1, "coley": 1, "william": 1, "h": 1, "green": 1, "klavs": 1, "f": 1, "jensen": 1}, {"rdchiral": 1, "rdkit": 1, "wrapper": 1, "handle": 1, "stereochemistry": 1, "retrosynthetic": 1, "template": 1, "extraction": 1, "application": 1}, {"journal": 1, "chemical": 1, "information": 1, "model": 1, "": 1}, {"32": 1, "ruiqi": 1, "guo": 1, "sanjiv": 1, "kumar": 1, "krzysztof": 1, "choromanski": 1, "david": 1, "simcha": 1}, {"quantization": 1, "base": 1, "fast": 1, "inner": 1, "product": 1, "search": 1}, {"artificial": 1, "intelligence": 1, "statistics": 1, "page": 1, "482490": 1, "2016": 1}, {"33": 1, "matthew": 1, "richardson": 1, "pedro": 1, "domingos": 1}, {"markov": 1, "logic": 1, "network": 1}, {"machine": 1, "learn": 1, "6212107136": 1, "2006": 1}, {"34": 1, "diederik": 1, "p": 1, "kingma": 1, "jimmy": 1, "ba": 1}, {"adam": 1, "method": 1, "stochastic": 1, "optimization": 1}, {"arxiv": 1, "preprint": 1, "arxiv14126980": 1, "2014": 1}, {"35": 1, "keyulu": 1, "xu": 1, "weihua": 1, "hu": 1, "jure": 1, "leskovec": 1, "stefanie": 1, "jegelka": 1}, {"powerful": 1, "graph": 1, "neural": 1, "network": 1}, {"arxiv": 1, "preprint": 1, "arxiv181000826": 1, "2018": 1}, {"11": 1}]